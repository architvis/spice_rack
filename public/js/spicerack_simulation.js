(()=>{"use strict";class t{constructor(t,e,i="entity",s=!0){this.visable=!0,this.active=s,this.type=i,this.x=t,this.y=e,this.xrel=0,this.yrel=0}}class e extends t{constructor(t,e,i="none",s){super(t,e,"spiceholder"),this.state=i,this.displayString=s}}class i extends t{constructor(t,i,s,c,a=7,r){var h;super(t,i,"spicerack"),this.spices=[],this.scale=s,this.position=[t,i],this.degree=c,this.targetDegree=0,this.state="idle",this.degStep=1,this.direction=0;let n=Math.sin,l=Math.cos;for(let t=0;t<a;t++){let i=t*(360/a)*Math.PI/180,s=0*l(i)+1*-n(i),c=0*n(i)+1*l(i);h=new e(s,c,"none"),this.spices.push(h),r.addEntity(h)}}updateChildren(){this.spices.forEach((t=>{t.xrel=0,t.yrel=0;let e=this.degree*Math.PI/180,i=Math.sin,s=Math.cos;t.xrel=t.x*s(e)+i(e)*t.y,t.yrel=t.x*-i(e)+s(e)*t.y,t.xrel=t.xrel*this.scale,t.yrel=t.yrel*this.scale,t.xrel=t.xrel+this.position[0],t.yrel=t.yrel+this.position[1]}))}moveTo(t){"idle"==this.state?(this.state="moveto",this.targetDegree=t):console.log("can't move in progress")}runMoveTo(t){this.targetDegree!=this.degree?1==this.direction?this.degree+=this.degStep:-1==this.direction&&(this.degree-=this.degStep):this.state="idle"}run(){if(this.degree+=this.degree<0?360:0,this.degree=this.degree%360,this.targetDegree+=this.targetDegree<0?360:0,this.targetDegree=this.targetDegree%360,"moveto"==this.state){let t;this.degree<this.targetDegree?(t=this.targetDegree-this.degree,this.direction=t<180?1:-1):(t=this.degree-this.targetDegree,this.direction=t>180?1:-1),this.state=1==this.direction?"movetoright":"movetoleft"}else"movetoright"==this.state?(this.direction=1,this.runMoveTo(1)):"movetoleft"==this.state&&(this.direction=-1,this.runMoveTo(-1))}}class s{constructor(t="canvas",e,i){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.entities=[]}addEntity(t){this.entities.push(t)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawEntities(){for(var t,e=0;e<this.entities.length;e++)switch((t=this.entities[e]).type){case"entity":case"inactive":break;case"spicerack":this.drawSpiceRack(t.x+t.xrel,t.y+t.yrel);break;case"spiceholder":"none"==t.state?this.drawSpiceHolder(t.x+t.xrel,t.y+t.yrel):"full"==t.state?this.drawSpice(t.x+t.xrel,t.y+t.yrel,t.displayString):"half"==t.state&&this.drawSpice(t.x+t.xrel,t.y+t.yrel)}}drawSpiceHolder(t,e){this.ctx.beginPath(),this.ctx.arc(t,e,40,0,2*Math.PI),this.ctx.stroke()}drawSpice(t,e,i=""){this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t,e,40,0,2*Math.PI),this.ctx.fill(),this.ctx.fillStyle="white",this.ctx.font="20px Arial",this.ctx.fillText(i,t-this.ctx.measureText(i).width/2,e+this.ctx.measureText("A").width/2),this.ctx.restore()}drawSpiceRack(t,e){this.ctx.beginPath(),this.ctx.arc(t,e,20,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(t,e,150,0,2*Math.PI),this.ctx.stroke();let i=[0,150];this.ctx.beginPath(),this.ctx.moveTo(t,e+i[1]+15),this.ctx.lineTo(t+15,e+i[1]+15),this.ctx.lineTo(t,e+i[1]-15),this.ctx.lineTo(t-15,e+i[1]+15),this.ctx.fill()}}function c(){let t=new s("spiceRackSimulate",200,200),e=new i(200,200,100,0,7,t);window.spiceRack1=e,t.addEntity(e);let c=new i(700,200,100,0,7,t);window.spiceRack2=c,t.addEntity(c),a(t,{spiceRack1:e,spiceRack2:c})}function a(t,e){t.clearCanvas(),e.spiceRack1.run(),e.spiceRack1.updateChildren(),e.spiceRack2.run(),e.spiceRack2.updateChildren(),e.spiceRack1.spices[0].state="full",e.spiceRack1.spices[0].displayString="0",e.spiceRack1.spices[1].state="full",e.spiceRack1.spices[1].displayString="1",e.spiceRack1.spices[6].state="full",e.spiceRack1.spices[6].displayString="6",e.spiceRack2.spices[5].state="full",e.spiceRack2.spices[5].displayString="Salt",e.spiceRack2.spices[3].state="full",e.spiceRack2.spices[3].displayString="Pepper",e.spiceRack2.spices[0].state="full",e.spiceRack2.spices[0].displayString="Garlic",t.drawEntities(),window.requestAnimationFrame((function(){a(t,e)}))}window.spiceRack1,window.spiceRack2,document.addEventListener("DOMContentLoaded",(function(){c()}))})();